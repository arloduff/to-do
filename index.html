<!-- index.html -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Organize your todo list</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.2.1/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.2.1/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/remarkable/1.6.2/remarkable.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="styles/main.css" />
  </head>
  <body>
      <div class="row"></div>
      <div class="vertical-spacer hidden-xs hidden-sm"></div>
      <div class="row row-centered">
        <div class="col-lg-3 col-centered hidden-xs hidden-sm"></div>
        <div id="content" class="col-lg-6 col-centered">
          <div id="to-do-app"></div>
        </div><!-- .col-lg-6.col-centered -->
        <div class="col-lg-3 col-centered hidden-xs hidden-sm"></div>
      </div><!-- .row.row-centered -->

    <script type="text/babel">
      // I would normally organize these classes into their own files and deliver them in
      // minified form to the end user using Grunt or a similar tool. But for the sake of
      // simplicity, I've kept them all here
      var ToDo = React.createClass({
        propTypes: {
          name: React.PropTypes.string
        },
        getInitialState: function () {
          return {
            completed: false
          }
        },
        
        toggleCompleted: function () {
          this.setState({
            completed: !this.state.completed
          });
        },
        
        render: function () {
          if(this.state.completed) {
            return(
              <div className="to-do-container">
                <input type="checkbox" onClick={this.toggleCompleted} />
                <div className="to-do complete">{this.props.name}</div>
              </div>);
          } else {
            return( 
              <div className="to-do-container">
                <input type="checkbox" onClick={this.toggleCompleted} />
                <div className="to-do">{this.props.name}</div>
              </div>);
          }
        }
      });
      
      var TodoAdder = React.createClass({
        propTypes: {
          onAddTodo: React.PropTypes.func
        },
      
        getInitialState: function () {
          return {
            text: ""
          };
        },
        
        handleTyping: function (e) {
          this.setState({
            text: e.target.value
          });
        },
        
        handleAddTodoClick () {
          this.props.onAddTodo(this.state.text);
          this.setState({
            text: ""
          });
        },
      
        render: function () {
          return(
            <div className="input-group">
              <input type="text" className="form-control col-md-3" placeholder="What do you need to get done?" onChange={this.handleTyping} value={this.state.text} />
              <span className="input-group-btn">
                <button className="hidden-xs hidden-sm btn btn-default add-to-do" type="button" onClick={this.handleAddTodoClick}>Add To-do</button>
                <button className="hidden-md hidden-lg btn btn-default add-to-do" type="button" onClick={this.handleAddTodoClick}>+</button>
              </span>
            </div>
          );
        }
      });
      
      var ToDoList = React.createClass({
        getInitialState: function () {
          return {
            todos: []
          };
        },
        
        addTodo: function (todo) {
          if(todo === "") {
            return;
          }
          // Avoid modifying state variables directly
          var newTodos = this.state.todos.slice(0);
          newTodos.push(todo);
          
          this.setState({
            todos: newTodos
          });
        },
        
        render: function () {
          return(
            <div>
              <TodoAdder onAddTodo={this.addTodo} />
              {this.state.todos.map(function (todo, key) {
                return <ToDo key={key} name={todo} />
             })}
          </div>
          );
        }
      });
      
      ReactDOM.render(
        <ToDoList />,
        document.getElementById('to-do-app')
      );
    </script>
  </body>
</html>
